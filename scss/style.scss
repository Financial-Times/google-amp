$o-fonts-path: '//h2.ft.com/build/v2/files/o-fonts-assets@1.3.0/';
$o-grid-ie8-rules: 'none';

@import 'o-colors/main';
@import 'o-fonts/main';
@import 'o-typography/main';
@import 'o-grid/main';

@import 'o-buttons/main';

@import 'header';
// @import 'sidebar';
@import 'footer';

@import 'hacks';

@include oFontsInclude(MetricWeb, regular); // body
@include oFontsInclude(MetricWeb, bold); // headings
@include oFontsInclude(FinancierDisplayWeb); // headings

$page-width: 30em;

$border-divider: 1px solid oColorsGetPaletteColor(pink-tint3);

@mixin responsiveWidth($width: $page-width) {
	margin: 0 auto;
	padding: 0 10px;
	max-width: $width;
}

@function pxAndVhToViewport($vh, $px) {
	@return $px * 100vh / $vh;
}

@mixin responsiveType($size, $min: 20px, $max: 50px) {
	font-size: $size;
	$min-size: ($size - 3vh) / 0.5vh + $min;
	$max-size: max($min-size, $max);

	@if $min != 0 {
		@media (max-height: pxAndVhToViewport($size, $min-size)) {
			font-size: $min-size;
		}
	}

	@if $max != 0 {
		@media (min-height: pxAndVhToViewport($size, $max-size)) {
			font-size: $max-size;
		}
	}
}

body {
	@include oColorsFor(page, background);
}

.main-wrapper {
	display: flex;
	flex-direction: column;
	min-height: 100vh;
}

.main {
	@include responsiveWidth;
	flex-grow: 1;
}

.article {
	@include oTypographyBodyWrapper;

	a {
		border-bottom-color: transparent;

		&:hover {
			border-bottom-color: inherit;
		}
	}
}

.article__copyright-notice.article__copyright-notice {
	@include oTypographySans(s);
}

.article-image {
	margin: 1em 0;
}

.article-header .article-image {
	border-bottom: $border-divider;
}

// HACK: override default styling of oTypographyBodyWrapper
// (rendered as '.article h1') using double classname specificity
.headline.headline {
	margin: 8px 0;

	@include oGridRespondTo($until: M) {
		@include responsiveType(8vh);
		line-height: 1;

		@media (orientation: portrait) {
			@include responsiveType(4vh);
		}
	}
}

// HACK: override default styling of oTypographyBodyWrapper
// (rendered as '.article h1') using double classname specificity
.article-standfirst.article-standfirst {
	margin: 6px 0;
	@include oTypographyLead;

	@include oGridRespondTo($until: M) {
		@include responsiveType(5vh);
		line-height: 1.2;
		@media (orientation: portrait) {
			@include responsiveType(3vh);
		}
	}
}

.article-dateline {
	@include oTypographySans(s);
	margin-top: 1em;
	margin-bottom: 1em;
}

.article-author-byline__author.article-author-byline__author {
	color: oColorsGetPaletteColor(claret);
	font-weight: bold;
}

.primary-theme.primary-theme {
	color: oColorsGetPaletteColor(claret);
	@include oTypographySansBold(l);

	@include oGridRespondTo($until: M) {
		@include responsiveType(6vh);
		line-height: 1;
		@media (orientation: portrait) {
			@include responsiveType(3vh);
		}
	}

	margin: 0.5em 0;

	a {
		color: inherit;
	}
}


// next-article component styles
.c-box {
	position: relative;
	clear: left;
	margin: 24px 0 16px;
	padding: 16px 0;
	width: 100%;

	box-sizing: border-box;
}

.c-box--inline {
	float: left;

	@include oGridRespondTo(S) {
		margin-right: 24px;
		max-width: 300px;
	}
}

.c-box__title {
	margin: -40px 0 8px 10px;
}

.c-box__title-text {
	@include oColorsFor(page, background);
	@include oTypographySerifDisplay(m);
	display: inline-block;
	margin: 0;
	padding: 10px;
	padding-bottom: 0;
	font-weight: 900;

	a {
		border-bottom: 0;
		text-decoration: none;
		color: oColorsGetPaletteColor('cold-1');
	}
}

.u-border--all {
	border: 1px solid oColorsGetPaletteColor('warm-3');
}

.u-border--left {
	border-left: 1px solid oColorsGetPaletteColor('warm-3');
}

.u-margin--left-right {
	margin-right: 16px;
	margin-left: 16px;
}

.u-padding--left-right {
	padding-right: 16px;
	padding-left: 16px;
}

.aside--headline {
	@include oTypographySansDataBold(xl);
	margin-top: 8px;
	margin-bottom: 8px;
	color: oColorsGetPaletteColor('cold-3');

	p {
		margin: 0;
	}
}

.aside--content p {
	margin: 5px 0 0;
}

.aside--image img {
	display: block;
	margin-right: auto;
	margin-left: auto;
	max-width: 100%;
}

.aside--list {
	margin: 10px 0;
	padding-left: 20px;
}

%article-quote::before {
	@include oTypographySerifDisplay(s);
	display: inline-block;
	vertical-align: -.5em; // sit around the baseline
	line-height: inherit;
	font-size: 80px; // enormous quote
	content: '\201C';
}

.pull-quote__quote-marks {
	@extend %article-quote;

	position: absolute;
	top: -1px; // place just on top of border
	left: 10px;
	background-color: oColorsGetPaletteColor('pink');
	padding: 0 10px;
	line-height: 0; // take up as little space as possible
}

.article__quote--full-quote {
	@extend %article-quote;
	line-height: 0; // take up as little space as possible
}

.article__quote-footer {
	@include oTypographySansBold(s);
}

.article-big-number {
	color: oColorsGetPaletteColor('grey-tint4');

	// Reset oTypographyBodyWrapper
	p {
		font-size: inherit;
		font-family: inherit;
		font-weight: inherit;
		color: inherit;
		line-height: inherit;
	}
}

.article-big-number__title {
	@include oTypographySerifDisplayBold(xl);
	font-size: 3em;
	line-height: 1em;
}

.article-big-number__content {
	font-size: 0.8em;
	line-height: 1;
}


// Related Content

.related-content {
	margin-top: 40px;
}

.related-content__header {
	@include oTypographySerifDisplay(m);
}

.related-content__stories {
	@include oGridRow();

	// Should we use a CSS reset?
	padding: 0;
}

.related-content__story {
	@include oGridColspan((default: 12, M: 6));
	margin-bottom: oGridGutter(L);

	@include oGridRespondTo(M) {
		display: flex;
	}
}

.related-content__lead-story {
	display: none;
	@include oGridRespondTo(M) {
		@include oGridColspan((default: 12));
		@include oGridRespondTo(M) {
			padding-left: oGridGutter(L) * 2;
		}
	}

	.related-content__container {
		@include oGridRow();
		@include oGridRespondTo(M) {
			margin-left: oGridGutter(L) * -1;
		}
	}

	.related-content__content,
	.related-content__image {
		@include oGridColspan((default: 6));
	}

	.related-content__content {
		@include oGridRespondTo(M) {
			padding-left: 0;
			padding-right: oGridGutter(L) / 2;
		}
	}

	.related-content__image {
		@include oGridRespondTo(M) {
			padding: 0;
			margin: oGridGutter(L) / 2 * -1 0;
			position: relative;
			right: oGridGutter(L) / 2 * -1;
		}
	}
}

.related-content__lead-story-alternate {
	@include oGridRespondTo(M) {
		display: none;
	}
}

.related-content__container {
	background-color: oColorsGetColorFor(box, background);
	border: 1px solid oColorsGetPaletteColor("warm-3");
	padding: oGridGutter(S);

	@include oGridRespondTo(M) {
		width: 100%;
	}
}

.related-content__link {
	@include oTypographyLink;
	@include oTypographySans(m);
}

.related-content__date {
	@include oTypographySans(xs);
	display: block;
	margin-top: 1em;
}

.related-content__summary {
	@include oTypographySans(s);
	margin: 0;
	display: block;
}

.related-content__theme {
	@include oTypographySansBold(s);
	color: oColorsGetPaletteColor(claret);
	margin: 0;
}

.related-content__theme-link {
	text-decoration: none;
	color: inherit;
}

.more-ons {
	margin-top: 40px;
}

.more-ons__items {
	@include oGridRow();

	// Should we use a CSS reset?
	padding: 0;
}

.more-ons__item {
	@include oGridColspan((default: 12, M: 6));
}

.more-ons__item-wrapper {
	border: 1px solid oColorsGetPaletteColor('warm-3');
	padding: oGridGutter(L) oGridGutter(L) 0;
	margin-bottom: oGridGutter(L);
}

.more-ons__type {
	margin: -40px 0 8px 10px;
}

.more-ons__header {
	@include oTypographySansBold(l);
	color: oColorsGetPaletteColor(claret);
	margin-top: 0;
}

.more-ons__header,
.more-ons__stories {
	padding: 0;
}

.more-ons__stories {
	list-style: none;
}

.more-ons__story {
	margin-bottom: oGridGutter(L);
}

.more-ons__link {
	@include oTypographyLink;
	@include oTypographySans(m);
}

.more-ons__date {
	@include oTypographySans(xs);
	display: block;
	margin-top: 0.5em;
}

.more-ons__image {
	margin: 0 oGridGutter(L) * -1 oGridGutter(L);
}


// Barriers, access
.access-mocked {
	position: absolute;
	background: pink;
	font-size: 12px;
	top: 160px;
	width: 30%;
	line-height: 1em;
	padding: 10px;
	min-width: 90px;
	right: 0;
	z-index: 1;
}

.amp-access-login {
	@include oTypographySans(m);
	color: oColorsGetPaletteColor(grey-tint5);
	margin-top: 6vh;
	margin-bottom: 8vh;
	@include responsiveType(3vh, $max: 30px);
	line-height: 1.3;
}

.amp-access-login__header,
.amp-access-login__body {
	padding: 2vh;

	@include oGridRespondTo(M) {
		margin: 0 3vh;
	}
}

.amp-access-login__header {
	background-color: oColorsGetPaletteColor(warm-5);
}

.amp-access-login__header-instruction,
.amp-access-login__header-title {
	@include oGridRespondTo(M) {
		display: inline;
	}
}

.amp-access-login__header-instruction {
	font-weight: bold;
}

.amp-access-login__body {
	background-color: oColorsGetPaletteColor(pink-tint1);
	display: flex;
	justify-content: center;

	@include oGridRespondTo($until: S) {
		flex-direction: column;
	}
}

.amp-access-login__button {
	@include oButtons(big, standout);
	padding: 10px;
	margin: 1vh 10px;
	text-transform: inherit;
	line-height: 1.1;
}

// Slideshows
.slideshow {
	background: black;
	border: 1px solid black;
	position: relative;
	margin: 1em 0;

	amp-carousel {
		@media (orientation: landscape) {
			max-height: 100vh;
		}
	}
}

.slideshow__title,
.slideshow__caption {
	background-color: rgba(51, 51, 51, 0.8);
	color: #fff;
}

.slideshow__title.slideshow__title {
	@include oTypographySans(m);
	padding: 10px;
}

.slideshow__caption.slideshow__caption {
	box-sizing: border-box;
	position: absolute;
	bottom: 0;
	left: 0;
	right: 0;
	min-height: 30px;
	margin: 0;
	padding: 3px 8px;
}

.amp-image-lightbox-caption {
	max-height: none;
	font-size: 16px;
	line-height: 18px;
}

abbr[title] {
	border-bottom: 0;
	text-decoration: underline;
	text-decoration: underline dotted;
}
